<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<blueprint xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
           xmlns:ext="http://aries.apache.org/blueprint/xmlns/blueprint-ext/v1.0.0"
           xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

  <!-- Allow the use of system properties -->
  <ext:property-placeholder placeholder-prefix="$[" placeholder-suffix="]" />

  <cm:property-placeholder persistent-id="broker" update-strategy="none">
    <cm:default-properties>
      <cm:property name="brokerUrl" value="failover:tcp://localhost:61616" />
      <cm:property name="maxBrokerConnections" value="10" />
      <cm:property name="isPersistent" value="true" />
      <cm:property name="messageTimeout" value="60" />
    </cm:default-properties>
  </cm:property-placeholder>

  <bean id="broker"
        class="org.safehaus.subutai.core.broker.impl.BrokerImpl"
        init-method="init" destroy-method="dispose" scope="singleton" activation="eager">
    <argument value="${brokerUrl}" />
    <argument value="${maxBrokerConnections}" />
    <argument value="${isPersistent}" />
    <argument value="${messageTimeout}" />
  </bean>

  <service ref="broker" interface="org.safehaus.subutai.core.broker.api.Broker" />

</blueprint>
